
% 171
% 20210920: MHb(R) / hStripe0 / 3600-3500 / CM-DiI / yes / with Sam
s.baseDir = 'C:\SGL_DATA\output\catgt_ANM_0171_20210920_behavior_optotagging_001_g0';
s.d_stim = load('C:\Users\YoungJu Jo\Dropbox\Behavior\Bpod\Data\ANM_0171\Optostim1p\Session Data\ANM_0171_Optostim1p_20210920_164219.mat');
s.d_bhvr = load('C:\Users\YoungJu Jo\Dropbox\Behavior\Bpod\Data\ANM_0171\NoImageCueLightReward\Session Data\ANM_0171_NoImageCueLightReward_20210920_161237.mat');
s.info = '171_20210920';
cohort_info{1} = s;



% 178

% 20211115
s.baseDir = 'O:\users\YJ\Ephys\SpikeGLX\Processed\catgt_ANM_0178_20211115_behavior_optotagging_001_g0';
s.d_stim = load('C:\Users\YoungJu Jo\Dropbox\Behavior\Bpod\Data\ANM_0178\Optostim1pShort\Session Data\ANM_0178_Optostim1pShort_20211115_224416.mat');
s.d_bhvr = load('C:\Users\YoungJu Jo\Dropbox\Behavior\Bpod\Data\ANM_0178\NoImageCueLightReward\Session Data\ANM_0178_NoImageCueLightReward_20211115_214142.mat');
s.info = '178_20211115';
cohort_info{1} = s;

% 20211116
s.baseDir = 'O:\users\YJ\Ephys\SpikeGLX\Processed\catgt_ANM_0178_20211116_behavior_optotagging_001_g0';
s.d_stim = load('C:\Users\YoungJu Jo\Dropbox\Behavior\Bpod\Data\ANM_0178\Optostim1pShort\Session Data\ANM_0178_Optostim1pShort_20211116_230917.mat');
s.d_bhvr = load('C:\Users\YoungJu Jo\Dropbox\Behavior\Bpod\Data\ANM_0178\NoImageCueLightReward\Session Data\ANM_0178_NoImageCueLightReward_20211116_221429.mat');
s.info = '178_20211116';
cohort_info{1} = s;

% 20211118
s.baseDir = 'O:\users\YJ\Ephys\SpikeGLX\Processed\catgt_ANM_0178_20211118_behavior_optotagging_001_g0';
s.d_stim = load('C:\Users\YoungJu Jo\Dropbox\Behavior\Bpod\Data\ANM_0178\Optostim1pShort\Session Data\ANM_0178_Optostim1pShort_20211118_165608.mat');
s.d_bhvr = load('C:\Users\YoungJu Jo\Dropbox\Behavior\Bpod\Data\ANM_0178\NoImageCueLightReward\Session Data\ANM_0178_NoImageCueLightReward_20211118_162416.mat');
s.info = '178_20211118';
cohort_info{1} = s;

% 20211120
s.baseDir = 'O:\users\YJ\Ephys\SpikeGLX\Processed\catgt_ANM_0178_20211120_behavior_optotagging_001_g0';
s.d_stim = load('C:\Users\YoungJu Jo\Dropbox\Behavior\Bpod\Data\ANM_0178\Optostim1pShort\Session Data\ANM_0178_Optostim1pShort_20211120_224826.mat');
s.d_bhvr = load('C:\Users\YoungJu Jo\Dropbox\Behavior\Bpod\Data\ANM_0178\NoImageCueLightReward\Session Data\ANM_0178_NoImageCueLightReward_20211120_215953.mat');
s.info = '178_20211120';
cohort_info{1} = s;

% 20211121
s.baseDir = 'O:\users\YJ\Ephys\SpikeGLX\Processed\catgt_ANM_0178_20211121_behavior_optotagging_001_g0';
s.d_stim = load('C:\Users\YoungJu Jo\Dropbox\Behavior\Bpod\Data\ANM_0178\Optostim1pShort\Session Data\ANM_0178_Optostim1pShort_20211121_222346.mat');
s.d_bhvr = load('C:\Users\YoungJu Jo\Dropbox\Behavior\Bpod\Data\ANM_0178\NoImageCueLightReward\Session Data\ANM_0178_NoImageCueLightReward_20211121_215217.mat');
s.info = '178_20211121';
cohort_info{1} = s;

% 20211122 (septum)
s.baseDir = 'O:\users\YJ\Ephys\SpikeGLX\Processed\catgt_ANM_0178_20211122_behavior_001_g0';
s.d_stim = NaN;
s.d_bhvr = load('C:\Users\YoungJu Jo\Dropbox\Behavior\Bpod\Data\ANM_0178\NoImageCueLightReward\Session Data\ANM_0178_NoImageCueLightReward_20211122_125121.mat');
s.info = '178_20211122';
cohort_info{1} = s;

% 179

% 20211121 (septum)
s.baseDir = 'O:\users\YJ\Ephys\SpikeGLX\Processed\catgt_ANM_0179_20211121_behavior_001_g0';
s.d_stim = NaN;
s.d_bhvr = load('C:\Users\YoungJu Jo\Dropbox\Behavior\Bpod\Data\ANM_0179\NoImageCueLightReward\Session Data\ANM_0179_NoImageCueLightReward_20211122_015802.mat');
s.info = '179_20211121';
cohort_info{1} = s;

% 180

% 20211121
s.baseDir = 'O:\users\YJ\Ephys\SpikeGLX\Processed\catgt_ANM_0180_20211121_behavior_optotagging_001_g0';
s.d_stim = load('C:\Users\YoungJu Jo\Dropbox\Behavior\Bpod\Data\ANM_0180\Optostim1pShort\Session Data\ANM_0180_Optostim1pShort_20211121_172700.mat');
s.d_bhvr = load('C:\Users\YoungJu Jo\Dropbox\Behavior\Bpod\Data\ANM_0180\NoImageCueLightReward\Session Data\ANM_0180_NoImageCueLightReward_20211121_163129.mat');
s.info = '180_20211121';
cohort_info{1} = s;

% 20211122 (septum)
s.baseDir = 'O:\users\YJ\Ephys\SpikeGLX\Processed\catgt_ANM_0180_20211122_behavior_001_g0';
s.d_stim = NaN;
s.d_bhvr = load('C:\Users\YoungJu Jo\Dropbox\Behavior\Bpod\Data\ANM_0180\NoImageCueLightReward\Session Data\ANM_0180_NoImageCueLightReward_20211122_141557.mat');
s.info = '180_20211122';
cohort_info{1} = s;

% 181

% 20211118
s.baseDir = 'O:\users\YJ\Ephys\SpikeGLX\Processed\catgt_ANM_0181_20211118_behavior_optotagging_001_g0';
s.d_stim = load('C:\Users\YoungJu Jo\Dropbox\Behavior\Bpod\Data\ANM_0181\Optostim1pShort\Session Data\ANM_0181_Optostim1pShort_20211118_223529.mat');
s.d_bhvr = load('C:\Users\YoungJu Jo\Dropbox\Behavior\Bpod\Data\ANM_0181\NoImageCueLightReward\Session Data\ANM_0181_NoImageCueLightReward_20211118_214411.mat');
s.info = '181_20211118';
cohort_info{1} = s;

% 20211120
s.baseDir = 'O:\users\YJ\Ephys\SpikeGLX\Processed\catgt_ANM_0181_20211120_behavior_optotagging_001_g0';
s.d_stim = load('C:\Users\YoungJu Jo\Dropbox\Behavior\Bpod\Data\ANM_0181\Optostim1pShort\Session Data\ANM_0181_Optostim1pShort_20211120_172154.mat');
s.d_bhvr = load('C:\Users\YoungJu Jo\Dropbox\Behavior\Bpod\Data\ANM_0181\NoImageCueLightReward\Session Data\ANM_0181_NoImageCueLightReward_20211120_162734.mat');
s.info = '181_20211120';
cohort_info{1} = s;

% 20211121 (septum)
s.baseDir = 'O:\users\YJ\Ephys\SpikeGLX\Processed\catgt_ANM_0181_20211121_behavior_001_g0';
s.d_stim = NaN;
s.d_bhvr = load('C:\Users\YoungJu Jo\Dropbox\Behavior\Bpod\Data\ANM_0181\NoImageCueLightReward\Session Data\ANM_0181_NoImageCueLightReward_20211122_041526.mat');
s.info = '181_20211121';
cohort_info{1} = s;


% 175

% 20211014
s.baseDir = 'O:\users\YJ\Ephys\SpikeGLX\Processed\catgt_ANM_0175_20211014_behavior_optotagging_001_g0';
s.d_stim = load('C:\Users\YoungJu Jo\Dropbox\Behavior\Bpod\Data\ANM_0175\Optostim1pShort\Session Data\ANM_0175_Optostim1p_20211014_190242.mat');
s.d_bhvr = load('C:\Users\YoungJu Jo\Dropbox\Behavior\Bpod\Data\ANM_0175\NoImageCueLightReward\Session Data\ANM_0175_NoImageCueLightReward_20211014_181605.mat');
s.info = '175_20211014';
cohort_info{1} = s;

% 20211017
s.baseDir = 'O:\users\YJ\Ephys\SpikeGLX\Processed\catgt_ANM_0175_20211017_behavior_optotagging_001_g0';
s.d_stim = load('C:\Users\YoungJu Jo\Dropbox\Behavior\Bpod\Data\ANM_0175\Optostim1pShort\Session Data\ANM_0175_Optostim1p_20211017_183825.mat');
s.d_bhvr = load('C:\Users\YoungJu Jo\Dropbox\Behavior\Bpod\Data\ANM_0175\NoImageCueLightReward\Session Data\ANM_0175_NoImageCueLightReward_20211017_181924.mat');
s.info = '175_20211017';
cohort_info{1} = s;

% 20211027
s.baseDir = 'O:\users\YJ\Ephys\SpikeGLX\Processed\catgt_ANM_0175_20211027_behavior_optotagging_001_g0';
s.d_stim = load('C:\Users\YoungJu Jo\Dropbox\Behavior\Bpod\Data\ANM_0175\Optostim1pShort\Session Data\ANM_0175_Optostim1p_20211027_192649.mat');
s.d_bhvr = load('C:\Users\YoungJu Jo\Dropbox\Behavior\Bpod\Data\ANM_0175\NoImageCueLightReward\Session Data\ANM_0175_NoImageCueLightReward_20211027_184432.mat');
s.info = '175_20211027';
cohort_info{1} = s;

% 176

% 20211102
s.baseDir = 'O:\users\YJ\Ephys\SpikeGLX\Processed\catgt_ANM_0176_20211102_behavior_optotagging_001_g0';
s.d_stim = load('C:\Users\YoungJu Jo\Dropbox\Behavior\Bpod\Data\ANM_0176\Optostim1p\Session Data\ANM_0176_Optostim1p_20211102_162906.mat');
s.d_bhvr = load('C:\Users\YoungJu Jo\Dropbox\Behavior\Bpod\Data\ANM_0176\NoImageCueLightReward\Session Data\ANM_0176_NoImageCueLightReward_20211102_155315.mat');
s.info = '176_20211102';
cohort_info{1} = s;

% 20211104
s.baseDir = 'C:\SGL_DATA\output\catgt_ANM_0176_20211104_behavior_optotagging_001_g0';
s.d_stim = load('C:\Users\YoungJu Jo\Dropbox\Behavior\Bpod\Data\ANM_0176\Optostim1p\Session Data\ANM_0176_Optostim1p_20211104_165020.mat');
s.d_bhvr = load('C:\Users\YoungJu Jo\Dropbox\Behavior\Bpod\Data\ANM_0176\NoImageCueLightReward\Session Data\ANM_0176_NoImageCueLightReward_20211104_163655.mat');
s.info = '176_20211104';
cohort_info{1} = s;

% 20211105
s.baseDir = 'O:\users\YJ\Ephys\SpikeGLX\Processed\catgt_ANM_0176_20211105_behavior_optotagging_001_g0';
s.d_stim = load('C:\Users\YoungJu Jo\Dropbox\Behavior\Bpod\Data\ANM_0176\Optostim1pShort\Session Data\ANM_0176_Optostim1p_20211105_230420.mat');
s.d_bhvr = load('C:\Users\YoungJu Jo\Dropbox\Behavior\Bpod\Data\ANM_0176\NoImageCueLightReward\Session Data\ANM_0176_NoImageCueLightReward_20211105_215248.mat');
s.info = '176_20211105';
cohort_info{1} = s;

% 20211108
s.baseDir = 'O:\users\YJ\Ephys\SpikeGLX\Processed\catgt_ANM_0176_20211108_behavior_optotagging_001_g0';
s.d_stim = NaN;
s.d_bhvr = load('C:\Users\YoungJu Jo\Dropbox\Behavior\Bpod\Data\ANM_0176\NoImageCueLightReward\Session Data\ANM_0176_NoImageCueLightReward_20211108_223301.mat');
s.info = '176_20211108';
cohort_info{1} = s;

% 177

% 20211106
s.baseDir = 'O:\users\YJ\Ephys\SpikeGLX\Processed\catgt_ANM_0177_20211106_behavior_optotagging_001_g0';
s.d_stim = load('C:\Users\YoungJu Jo\Dropbox\Behavior\Bpod\Data\ANM_0177\Optostim1pShort\Session Data\ANM_0177_Optostim1p_20211106_150900.mat');
s.d_bhvr = load('C:\Users\YoungJu Jo\Dropbox\Behavior\Bpod\Data\ANM_0177\NoImageCueLightReward\Session Data\ANM_0177_NoImageCueLightReward_20211106_144556.mat');
s.info = '177_20211106';
cohort_info{1} = s;

% 20211107 - optotagging only
s.baseDir = 'C:\SGL_DATA\output\catgt_ANM_0177_20211107_optotagging_001_g0';
s.d_stim = load('C:\Users\YoungJu Jo\Dropbox\Behavior\Bpod\Data\ANM_0177\Optostim1p\Session Data\ANM_0177_Optostim1p_20211107_160919.mat');
s.d_bhvr = NaN;
s.info = '177_20211107_opto';
cohort_info{1} = s;

% 20211107
s.baseDir = 'O:\users\YJ\Ephys\SpikeGLX\Processed\catgt_ANM_0177_20211107_behavior_optotagging_001_g0';
s.d_stim = load('C:\Users\YoungJu Jo\Dropbox\Behavior\Bpod\Data\ANM_0177\Optostim1pShort\Session Data\ANM_0177_Optostim1p_20211107_225053.mat');
s.d_bhvr = load('C:\Users\YoungJu Jo\Dropbox\Behavior\Bpod\Data\ANM_0177\NoImageCueLightReward\Session Data\ANM_0177_NoImageCueLightReward_20211107_220946.mat');
s.info = '177_20211106';
cohort_info{1} = s;

% 20211108
s.baseDir = 'O:\users\YJ\Ephys\SpikeGLX\Processed\catgt_ANM_0177_20211108_behavior_optotagging_001_g0';
s.d_stim = load('C:\Users\YoungJu Jo\Dropbox\Behavior\Bpod\Data\ANM_0177\Optostim1pShort\Session Data\ANM_0177_Optostim1p_20211108_204841.mat');
s.d_bhvr = load('C:\Users\YoungJu Jo\Dropbox\Behavior\Bpod\Data\ANM_0177\NoImageCueLightReward\Session Data\ANM_0177_NoImageCueLightReward_20211108_201431.mat');
s.info = '177_20211106';
cohort_info{1} = s;







%%

for idx_sess = 1:numel(cohort_info)
    
    tic; 
    s = load_ephys_session(cohort_info{idx_sess}.baseDir);
    
    %{
    % quality control (pre-analysis)
    
    QC_fr = (s.metrics{:,3} > 0.2);
    %QC_isiviolation = (s.metrics{:,5} < 0.01);
    %QC_amplitudecutoff = (s.metrics{:,6} <= 0.1);
    %QC_presenceratio = (s.metrics{:,4} > 0.8);
    
    QC_passed = logical(QC_fr);
    %QC_passed = logical(QC_isiviolation);
    %QC_passed = logical(QC_isiviolation .* QC_amplitudecutoff);
    %QC_passed = logical(QC_isiviolation .* QC_amplitudecutoff .* QC_presenceratio);

    s.list_su = s.list_su(QC_passed);
    s.spike_su = s.spike_su(QC_passed);
    s.sites_su = s.sites_su(QC_passed);

    s.metrics = s.metrics(QC_passed,:);
    s.wf = s.wf(QC_passed,:,:);
    %}
    numUnit = numel(s.spike_su);
    
    
    % optotagging
    
    if 1 %isfield(s, 'wf_stim')
        
        % stim conditions
        
        trial_width = cohort_info{idx_sess}.d_stim.SessionData.TrialInfo.trial_width;
        trial_freq = cohort_info{idx_sess}.d_stim.SessionData.TrialInfo.trial_freq;
        trial_power = cohort_info{idx_sess}.d_stim.SessionData.TrialInfo.trial_power;
        s.trial_width = trial_width; s.trial_freq = trial_freq; s.trial_power = trial_power;
        
        list_width = cohort_info{idx_sess}.d_stim.SessionData.TrialInfo.list_width;
        list_freq = cohort_info{idx_sess}.d_stim.SessionData.TrialInfo.list_freq;
        list_power = cohort_info{idx_sess}.d_stim.SessionData.TrialInfo.list_power;
        s.list_width = list_width; s.list_freq = list_freq; s.list_power = list_power;

        pulse_width = zeros(length(s.TTL_stim),1);
        pulse_freq = zeros(length(s.TTL_stim),1);
        pulse_power = zeros(length(s.TTL_stim),1);
        len_pulse = zeros(length(s.TTL_stimblock),1);
        stimDuration = 1.0;  % sec
        for idx_bhvr = 1:length(s.TTL_stimblock)
            idx_pulse = find((s.TTL_stim > s.TTL_stimblock(idx_bhvr)) .* (s.TTL_stim < s.TTL_stimblock(idx_bhvr)+stimDuration));
            len_pulse(idx_bhvr) = length(idx_pulse);
            pulse_width(idx_pulse) = trial_width(idx_bhvr);
            pulse_freq(idx_pulse) = trial_freq(idx_bhvr);
            pulse_power(idx_pulse) = trial_power(idx_bhvr);
            % latency correction
            if ~isempty(idx_pulse)
                s.TTL_stimblock(idx_bhvr) = s.TTL_stim(idx_pulse(1));
            end
        end
        len_pulse(len_pulse==0) = -1;
        s.pulse_width = pulse_width; s.pulse_freq = pulse_freq; s.pulse_power = pulse_power; s.len_pulse = len_pulse;
        
        % spike-associated latency test (SALT)
        
        idxPulse = ((pulse_width==0.010).*(pulse_freq==10).*(pulse_power==5))==1;  % stim condition for optotagging 
        salt_p_all = zeros(length(s.spike_su),1); salt_I_all = zeros(length(s.spike_su),1);
        for idx_su = 1:length(s.spike_su)
            count_baseline = bin_spikes(s.TTL_stimblock-0.9, [0 0.8-0.001 0.001 1], s.spike_su(idx_su));
            count_test = bin_spikes(s.TTL_stim(idxPulse), [0 0.025 0.001 1], s.spike_su(idx_su));  % mean(sum(count_test,2))  % hardcoded 25 ms window
            [salt_p, salt_I] = salt(count_baseline,count_test,0.001,0.020);  % the "window size" should be carefully chosen!
            salt_p_all(idx_su) = salt_p; salt_I_all(idx_su) = salt_I;
        end
        s.salt_p = salt_p_all; s.salt_I = salt_I_all;
        
        % spike probability, latency, and jitter
        
        s.spike_probability = NaN(numUnit,1); s.spike_latency = NaN(numUnit,1); s.spike_jitter = NaN(numUnit,1);
        for idx_unit = 1:numUnit
            x = s.spike_su{idx_unit};
            if length(x) < 2
                continue;
            end
            ind = interp1(x,1:length(x),s.TTL_stim(idxPulse),'next');
            ind(isnan(ind)) = numel(x); % in case of no spike after a timestamp
            timestamp_to_spike = x(ind) - s.TTL_stim(idxPulse);
            is_spike_in_window = logical((timestamp_to_spike > 0) .* (timestamp_to_spike < 0.025));  % hardcoded 25 ms window
            if sum(is_spike_in_window) == 0
                continue;
            else
                s.spike_probability(idx_unit) = sum(is_spike_in_window) / sum(idxPulse);
                latency_data = timestamp_to_spike(is_spike_in_window);
                s.spike_latency(idx_unit) = mean(latency_data);
                s.spike_jitter(idx_unit) = std(latency_data);
            end
        end
        
        % waveform correlation
        %s.wf_corr = diag(corr(reshape(s.wf,numel(s.list_su),[])', reshape(s.wf_stim,numel(s.list_su),[])'));
        
    else
        
        s.salt_p = NaN(numUnit,1);
        s.salt_I = NaN(numUnit,1);
        s.spike_probability = NaN(numUnit,1);
        s.spike_latency = NaN(numUnit,1);
        s.spike_jitter = NaN(numUnit,1);
        s.wf_corr = NaN(numUnit,1);

    end
    
    cohort{idx_sess} = s;
    
    toc;

end



%% Optotagging plots

idx_sess = 1;

cohort{idx_sess}.tagged_unit = logical((cohort{idx_sess}.salt_I > 0.2) .* (cohort{idx_sess}.spike_latency < 0.020) .* (cohort{idx_sess}.spike_probability > 0.3));
cohort{idx_sess}.resp_unit_idx =find(cohort{idx_sess}.tagged_unit);
disp(sum(cohort{idx_sess}.tagged_unit));
disp(cohort{idx_sess}.list_su(cohort{idx_sess}.resp_unit_idx)');
% find(cohort{idx_sess}.list_su==285)
% cohort{idx_sess}.spike_latency(cohort{idx_sess}.resp_unit_idx)'


% PLOT 1
resp_unit_positions = cohort{idx_sess}.channel_positions(cohort{idx_sess}.sites_su(cohort{idx_sess}.resp_unit_idx)+1,:);
all_unit_positions = cohort{idx_sess}.channel_positions(cohort{idx_sess}.sites_su+1,:);
all_unit_positions = all_unit_positions + 5*randn(size(all_unit_positions));
figure; set(gcf,'color','w');
plot(s.channel_positions(:,1),s.channel_positions(:,2),'.k'); hold on;
plot(all_unit_positions(:,1), all_unit_positions(:,2), '.b', 'MarkerSize', 20); hold on;
plot(resp_unit_positions(:,1),resp_unit_positions(:,2),'*r', 'MarkerSize', 30); hold off;
xlabel('X coordinate (um)'); ylabel('Y coordinate (um)');
xlim([-100 900]); ylim([-100 800]);


% PLOT 2
idxTrial = ((trial_width==0.010).*(trial_freq==10).*(trial_power==5))==1;
plot_raster(s.TTL_stimblock(idxTrial), [-0.5 1.5 0.001 50], s.spike_su(cohort{idx_sess}.tagged_unit), s.list_su(cohort{idx_sess}.tagged_unit));
% plot_raster(s.TTL_stimblock(idxTrial), [-0.5 1.5 0.001 50], s.spike_su, s.list_su);


% PLOT 3
thres_salt_I = 0.2; 
figure; set(gcf,'color','w');
hist(cohort{idx_sess}.salt_I);
xlabel('"Distance" of stimulus-associated latency distribution'); 
xline(thres_salt_I, '--');

% PLOT 4
idx_unit = cohort{idx_sess}.resp_unit_idx(1);
figure; set(gcf,'color','w');
idxTrial = ((cohort{idx_sess}.trial_width==0.010).*(cohort{idx_sess}.trial_freq==10).*(cohort{idx_sess}.trial_power==5))==1;
generate_raster(cohort{idx_sess}.TTL_stimblock(idxTrial), [-0.2 1.2 0.001 5], cohort{idx_sess}.spike_su, cohort{idx_sess}.list_su, idx_unit);
stim_time = 0:(1/10):1; stim_time = stim_time(1:end-1);
for idx_stim = 1:length(stim_time)
    xline(stim_time(idx_stim),'color',[1,0,0],'alpha',0.2,'LineWidth',0.4);
end
title('Pulse width = 10 ms'); xlabel('Time from stim sequence onset');


%%

%
% 178
% 20211114
s.baseDir = 'D:\ephys_backup\Processed\catgt_ANM_0178_20211114_optotagging_001_g0';
s.d_stim = load('C:\Users\YoungJu Jo\Dropbox\Behavior\Bpod\Data\ANM_0178\Optostim1pShort\Session Data\ANM_0178_Optostim1pShort_20211114_223214.mat');
s.d_bhvr = NaN;
s.info = '178_20211114_1';
cohort_info{1} = s;

s.baseDir = 'D:\ephys_backup\Processed\catgt_ANM_0178_20211114_optotagging_002_g0';
s.d_stim = load('C:\Users\YoungJu Jo\Dropbox\Behavior\Bpod\Data\ANM_0178\Optostim1pShort\Session Data\ANM_0178_Optostim1pShort_20211114_230701.mat');
s.d_bhvr = NaN;
s.info = '178_20211114_2';
cohort_info{1} = s;

s.baseDir = 'D:\ephys_backup\Processed\catgt_ANM_0178_20211114_optotagging_003_g0';
s.d_stim = load('C:\Users\YoungJu Jo\Dropbox\Behavior\Bpod\Data\ANM_0178\Optostim1pShort\Session Data\ANM_0178_Optostim1pShort_20211114_234408.mat');
s.d_bhvr = NaN;
s.info = '178_20211114_3';
cohort_info{1} = s;

s.baseDir = 'C:\SGL_DATA\output\catgt_ANM_0178_20211115_behavior_optotagging_001_g0';
s.d_stim = load('C:\Users\YoungJu Jo\Dropbox\Behavior\Bpod\Data\ANM_0178\Optostim1pShort\Session Data\ANM_0178_Optostim1pShort_20211115_224416.mat');
s.d_bhvr = NaN;
s.info = '178_20211115';
cohort_info{1} = s;

s.baseDir = 'C:\SGL_DATA\output\catgt_ANM_0178_20211116_behavior_optotagging_001_g0';
s.d_stim = load('C:\Users\YoungJu Jo\Dropbox\Behavior\Bpod\Data\ANM_0178\Optostim1pShort\Session Data\ANM_0178_Optostim1pShort_20211116_230917.mat');
s.d_bhvr = NaN;
s.info = '178_20211116';
cohort_info{1} = s;

s.baseDir = 'C:\SGL_DATA\output\catgt_ANM_0178_20211118_behavior_optotagging_001_g0';
s.d_stim = load('C:\Users\YoungJu Jo\Dropbox\Behavior\Bpod\Data\ANM_0178\Optostim1pShort\Session Data\ANM_0178_Optostim1pShort_20211118_165608.mat');
s.d_bhvr = NaN;
s.info = '178_20211118';
cohort_info{1} = s;

s.baseDir = 'C:\SGL_DATA\output\catgt_ANM_0178_20211120_behavior_optotagging_001_g0';
s.d_stim = load('C:\Users\YoungJu Jo\Dropbox\Behavior\Bpod\Data\ANM_0178\Optostim1pShort\Session Data\ANM_0178_Optostim1pShort_20211120_224826.mat');
s.d_bhvr = NaN;
s.info = '178_20211120';
cohort_info{1} = s;

s.baseDir = 'O:\users\YJ\Ephys\SpikeGLX\Processed\catgt_ANM_0178_20211121_behavior_optotagging_001_g0';
s.d_stim = load('C:\Users\YoungJu Jo\Dropbox\Behavior\Bpod\Data\ANM_0178\Optostim1pShort\Session Data\ANM_0178_Optostim1pShort_20211121_222346.mat');
s.d_bhvr = NaN;
s.info = '178_20211121';
cohort_info{1} = s;

%
% 179
% 20211115
s.baseDir = 'D:\ephys_backup\Processed\catgt_ANM_0179_20211115_optotagging_001_g0';
s.d_stim = load('C:\Users\YoungJu Jo\Dropbox\Behavior\Bpod\Data\ANM_0179\Optostim1pShort\Session Data\ANM_0179_Optostim1pShort_20211115_125642.mat');
s.d_bhvr = NaN;
s.info = '179_20211115_1';
cohort_info{1} = s;

s.baseDir = 'D:\ephys_backup\Processed\catgt_ANM_0179_20211115_optotagging_002_g0';
s.d_stim = load('C:\Users\YoungJu Jo\Dropbox\Behavior\Bpod\Data\ANM_0179\Optostim1pShort\Session Data\ANM_0179_Optostim1pShort_20211115_140918.mat');
s.d_bhvr = NaN;
s.info = '179_20211115_2';
cohort_info{1} = s;

s.baseDir = 'D:\ephys_backup\Processed\catgt_ANM_0179_20211120_behavior_optotagging_001_g0';
s.d_stim = load('C:\Users\YoungJu Jo\Dropbox\Behavior\Bpod\Data\ANM_0179\Optostim1pShort\Session Data\ANM_0179_Optostim1pShort_20211121_015331.mat');
s.d_bhvr = NaN;
s.info = '179_20211120';
cohort_info{1} = s;

%
% 180
% 20211115
s.baseDir = 'D:\ephys_backup\Processed\catgt_ANM_0180_20211115_optotagging_001_g0';
s.d_stim = load('C:\Users\YoungJu Jo\Dropbox\Behavior\Bpod\Data\ANM_0180\Optostim1pShort\Session Data\ANM_0180_Optostim1pShort_20211115_150825.mat');
s.d_bhvr = NaN;
s.info = '180_20211115_1';
cohort_info{1} = s;

s.baseDir = 'D:\ephys_backup\Processed\catgt_ANM_0180_20211115_optotagging_002_g0';
s.d_stim = load('C:\Users\YoungJu Jo\Dropbox\Behavior\Bpod\Data\ANM_0180\Optostim1pShort\Session Data\ANM_0180_Optostim1pShort_20211115_153909.mat');
s.d_bhvr = NaN;
s.info = '180_20211115_2';
cohort_info{1} = s;

s.baseDir = 'C:\SGL_DATA\output\catgt_ANM_0180_20211121_behavior_optotagging_001_g0';
s.d_stim = load('C:\Users\YoungJu Jo\Dropbox\Behavior\Bpod\Data\ANM_0180\Optostim1pShort\Session Data\ANM_0180_Optostim1pShort_20211121_172700.mat');
s.d_bhvr = NaN;
s.info = '180_20211121';
cohort_info{1} = s;


%
% 181
% 20211115
s.baseDir = 'D:\ephys_backup\Processed\catgt_ANM_0181_20211115_optotagging_001_g0';
s.d_stim = load('C:\Users\YoungJu Jo\Dropbox\Behavior\Bpod\Data\ANM_0181\Optostim1pShort\Session Data\ANM_0181_Optostim1pShort_20211115_163300.mat');
s.d_bhvr = NaN;
s.info = '181_20211115_1';
cohort_info{1} = s;

s.baseDir = 'D:\ephys_backup\Processed\catgt_ANM_0181_20211115_optotagging_002_g0';
s.d_stim = load('C:\Users\YoungJu Jo\Dropbox\Behavior\Bpod\Data\ANM_0181\Optostim1pShort\Session Data\ANM_0181_Optostim1pShort_20211115_172025.mat');
s.d_bhvr = NaN;
s.info = '181_20211115_2';
cohort_info{1} = s;

s.baseDir = 'C:\SGL_DATA\output\catgt_ANM_0181_20211118_behavior_optotagging_001_g0';
s.d_stim = load('C:\Users\YoungJu Jo\Dropbox\Behavior\Bpod\Data\ANM_0181\Optostim1pShort\Session Data\ANM_0181_Optostim1pShort_20211118_223529.mat');
s.d_bhvr = NaN;
s.info = '181_20211118';
cohort_info{1} = s;

s.baseDir = 'C:\SGL_DATA\output\catgt_ANM_0181_20211120_behavior_optotagging_001_g0';
s.d_stim = load('C:\Users\YoungJu Jo\Dropbox\Behavior\Bpod\Data\ANM_0181\Optostim1pShort\Session Data\ANM_0181_Optostim1pShort_20211120_172154.mat');
s.d_bhvr = NaN;
s.info = '181_20211120';
cohort_info{1} = s;


%
% 188
% 20211201
s.baseDir = 'C:\SGL_DATA\output\catgt_ANM_0188_20211201_optotagging_001_g0';
s.d_stim = load('C:\Users\YoungJu Jo\Dropbox\Behavior\Bpod\Data\ANM_0188\Optostim1pShort\Session Data\ANM_0188_Optostim1pShort_20211201_180104.mat');
s.d_bhvr = NaN;
s.info = '188_20211201_1';
cohort_info{1} = s;

s.baseDir = 'C:\SGL_DATA\output\catgt_ANM_0188_20211201_optotagging_002_g0';
s.d_stim = load('C:\Users\YoungJu Jo\Dropbox\Behavior\Bpod\Data\ANM_0188\Optostim1pShort\Session Data\ANM_0188_Optostim1pShort_20211201_182433.mat');
s.d_bhvr = NaN;
s.info = '188_20211201_2';
cohort_info{1} = s;

s.baseDir = 'C:\SGL_DATA\output\catgt_ANM_0188_20211201_optotagging_003_g0';
s.d_stim = load('C:\Users\YoungJu Jo\Dropbox\Behavior\Bpod\Data\ANM_0188\Optostim1pShort\Session Data\ANM_0188_Optostim1pShort_20211201_190607.mat');
s.d_bhvr = NaN;
s.info = '188_20211201_3';
cohort_info{1} = s;

% 20211202
s.baseDir = 'D:\ephys_backup\Processed\catgt_ANM_0188_20211202_behavior_stim_optotagging_001_g0';
s.d_stim = load('C:\Users\YoungJu Jo\Dropbox\Behavior\Bpod\Data\ANM_0188\Optostim1pShort\Session Data\ANM_0188_Optostim1pShort_20211202_175829.mat');
s.d_bhvr = NaN;
s.info = '188_20211202';
cohort_info{1} = s;

% 20211203
s.baseDir = 'D:\ephys_backup\Processed\catgt_ANM_0188_20211203_behavior_stim_optotagging_001_g0';
s.d_stim = load('C:\Users\YoungJu Jo\Dropbox\Behavior\Bpod\Data\ANM_0188\Optostim1pShort\Session Data\ANM_0188_Optostim1pShort_20211203_151948.mat');
s.d_bhvr = NaN;
s.info = '188_20211203';
cohort_info{1} = s;


%
% 190
% 20211201
s.baseDir = 'C:\SGL_DATA\output\catgt_ANM_0190_20211201_optotagging_001_g0';
s.d_stim = load('C:\Users\YoungJu Jo\Dropbox\Behavior\Bpod\Data\ANM_0190\Optostim1pShort\Session Data\ANM_0190_Optostim1pShort_20211202_001552.mat');
s.d_bhvr = NaN;
s.info = '190_20211201_1';
cohort_info{1} = s;

s.baseDir = 'C:\SGL_DATA\output\catgt_ANM_0190_20211201_optotagging_002_g0';
s.d_stim = load('C:\Users\YoungJu Jo\Dropbox\Behavior\Bpod\Data\ANM_0190\Optostim1pShort\Session Data\ANM_0190_Optostim1pShort_20211202_011437.mat');
s.d_bhvr = NaN;
s.info = '190_20211201_2';
cohort_info{1} = s;

% 20211202
s.baseDir = 'D:\ephys_backup\Processed\catgt_ANM_0190_20211202_behavior_stim_optotagging_001_g0';
s.d_stim = load('C:\Users\YoungJu Jo\Dropbox\Behavior\Bpod\Data\ANM_0190\Optostim1pShort\Session Data\ANM_0190_Optostim1pShort_20211203_002346.mat');
s.d_bhvr = NaN;
s.info = '190_20211202';
cohort_info{1} = s;

% 20211203
s.baseDir = 'D:\ephys_backup\Processed\catgt_ANM_0190_20211203_behavior_stim_optotagging_001_g0';
s.d_stim = load('C:\Users\YoungJu Jo\Dropbox\Behavior\Bpod\Data\ANM_0190\Optostim1pShort\Session Data\ANM_0190_Optostim1pShort_20211203_165827.mat');
s.d_bhvr = NaN;
s.info = '190_20211203';
cohort_info{1} = s;





